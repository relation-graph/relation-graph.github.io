import{n as s}from"./index-589c1747.js";var r=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",[t("div",{staticStyle:{height:"calc(100vh - 60px)"}},[t("RelationGraph",{ref:"graphRef",attrs:{options:e.graphOptions,"on-node-click":e.onNodeClick,"on-line-click":e.onLineClick},scopedSlots:e._u([{key:"graph-plug",fn:function(){return[t("div",{staticClass:"c-my-panel"},[t("div",{staticClass:"c-option-name"},[e._v("布局次数："+e._s(e.graphOptions.layout.maxLayoutTimes))]),t("el-slider",{attrs:{min:10,max:1e3,step:100,"show-tooltip":!0},model:{value:e.graphOptions.layout.maxLayoutTimes,callback:function(a){e.$set(e.graphOptions.layout,"maxLayoutTimes",a)},expression:"graphOptions.layout.maxLayoutTimes"}}),t("div",{staticClass:"c-option-name"},[e._v("节点斥力系数："+e._s(e.graphOptions.layout.force_node_repulsion)+"     （设置太大会抖动）")]),t("el-slider",{attrs:{min:.01,step:.05,max:4},model:{value:e.graphOptions.layout.force_node_repulsion,callback:function(a){e.$set(e.graphOptions.layout,"force_node_repulsion",a)},expression:"graphOptions.layout.force_node_repulsion"}}),t("div",{staticClass:"c-option-name"},[e._v("连线牵引力系数："+e._s(e.graphOptions.layout.force_line_elastic)+"     （设置太大会抖动）")]),t("el-slider",{attrs:{min:.01,step:.05,max:4},model:{value:e.graphOptions.layout.force_line_elastic,callback:function(a){e.$set(e.graphOptions.layout,"force_line_elastic",a)},expression:"graphOptions.layout.force_line_elastic"}}),t("div",{staticClass:"c-option-name"},[e._v("观察对象：")]),t("el-radio-group",{attrs:{size:"mini"},model:{value:e.configType,callback:function(a){e.configType=a},expression:"configType"}},[t("el-radio-button",{attrs:{label:"node"}},[e._v("Node")]),t("el-radio-button",{attrs:{label:"line"}},[e._v("Line")])],1),t("div",{staticStyle:{padding:"5px"}},[e.configType==="node"?t("div",{staticStyle:{"padding-right":"10px"}},[t("div",{staticClass:"c-option-name"},[e._v("随机范围：("+e._s(e.rangeForNode[0])+", "+e._s(e.rangeForNode[1])+")")]),t("el-slider",{attrs:{range:"",min:.2,max:30},model:{value:e.rangeForNode,callback:function(a){e.rangeForNode=a},expression:"rangeForNode"}}),t("el-link",{attrs:{size:"mini",plain:"",type:"primary"},on:{click:e.randomNodeWeight}},[e._v("随机重置节点重量")])],1):e._e(),e.configType==="line"?t("div",{staticStyle:{"padding-right":"10px"}},[t("div",{staticClass:"c-option-name"},[e._v("随机范围：("+e._s(e.rangeForLine[0])+", "+e._s(e.rangeForLine[1])+")")]),t("el-slider",{attrs:{range:"",min:.2,max:30},model:{value:e.rangeForLine,callback:function(a){e.rangeForLine=a},expression:"rangeForLine"}}),t("el-link",{attrs:{size:"mini",type:"primary"},on:{click:e.randomLineWeight}},[e._v("随机重置连线牵引力")])],1):e._e()]),t("el-divider"),t("div",{staticStyle:{padding:"5px"}},[t("el-button",{attrs:{size:"small",round:"",type:"primary"},on:{click:e.updateLayouterOptions}},[e._v("应用并继续布局")]),t("el-button",{attrs:{size:"small",round:"",type:"primary"},on:{click:e.refresh}},[e._v("应用并刷新重新开始")])],1),t("div",{staticStyle:{padding:"10px"}},[t("el-link",{attrs:{size:"mini",type:"primary"},on:{click:e.addNodes}},[e._v("给被选中的节点加两个子节点")])],1)],1)]},proxy:!0}])})],1)])},l=[];const c={name:"Demo",components:{},data(){return{configType:"node",rangeForNode:[1,30],rangeForLine:[1,30],graphOptions:{debug:!1,defaultNodeBorderWidth:0,allowSwitchLineShape:!0,allowSwitchJunctionPoint:!0,defaultLineShape:1,layout:{layoutName:"force",maxLayoutTimes:100,force_node_repulsion:.5,force_line_elastic:.5},defaultJunctionPoint:"border"}}},mounted(){this.showSeeksGraph()},beforeDestroy(){console.log("beforeDestroy stop layout"),this.$refs.graphRef.getInstance().stopAutoLayout()},methods:{async showSeeksGraph(){const e={rootId:"root",nodes:[{id:"root",text:"Root",force_weight:600}],lines:[]};for(let t=0;t<30;t++){const a={id:"n"+t,text:""},n={from:e.rootId,to:a.id,text:""};e.nodes.push(a),e.lines.push(n)}await this.$refs.graphRef.getInstance().setJsonData(e),this.randomNodeWeight()},onNodeClick(e,o){console.log("onNodeClick:",e)},onLineClick(e,o,t){console.log("onLineClick:",e)},randomNodeWeight(){this.resetNodeAndLineForceOptions();const e=this.$refs.graphRef.getInstance();e.getNodes().forEach(o=>{if(o===e.graphData.rootNode)return;const t=this.rangeForNode[0]+Math.random()*this.rangeForNode[1];o.width=10+10*Math.sqrt(t),o.height=10+10*Math.sqrt(t),o.force_weight=t,o.text=t.toFixed(1)})},randomLineWeight(){this.resetNodeAndLineForceOptions(),this.$refs.graphRef.getInstance().getLinks().forEach(o=>{const t=o.relations[0],a=this.rangeForLine[0]+Math.random()*this.rangeForLine[1];t.force_elastic=a,t.text=a.toFixed(1)})},resetNodeAndLineForceOptions(){const e=this.$refs.graphRef.getInstance();e.getNodes().forEach(o=>{o!==e.graphData.rootNode&&(o.width=30,o.height=30,o.force_weight=void 0,o.text="")}),e.getLinks().forEach(o=>{const t=o.relations[0];t.force_elastic=void 0,t.text=""})},async updateLayouterOptions(){const e=this.$refs.graphRef.getInstance();await e.stopAutoLayout(),e.layouter.maxLayoutTimes=this.graphOptions.layout.maxLayoutTimes,e.layouter.force_node_repulsion=this.graphOptions.layout.force_node_repulsion,e.layouter.force_line_elastic=this.graphOptions.layout.force_line_elastic,setTimeout(async()=>{await e.startAutoLayout()},500)},async refresh(){const e=this.$refs.graphRef.getInstance();await e.stopAutoLayout(),e.layouter.maxLayoutTimes=this.graphOptions.layout.maxLayoutTimes,e.layouter.force_node_repulsion=this.graphOptions.layout.force_node_repulsion,e.layouter.force_line_elastic=this.graphOptions.layout.force_line_elastic,e.refresh()},addNodes(){const e=this.$refs.graphRef.getInstance(),o=e.options.checkedNodeId||e.graphData.rootNode.id,t=e.generateNewNodeId(),a=[{id:t+"-1",text:"New node"},{id:t+"-2",text:"New node"}];a.forEach(n=>{n.x=Math.floor(Math.random()*40),n.y=Math.floor(Math.random()*40)}),e.addNodes(a),e.addLines([{from:o,to:t+"-1",text:"New"},{from:o,to:t+"-2",text:"New"}]),e.layouter.allNodes=e.graphData.nodes,e.layouter.allLinks=e.graphData.links,e.layouter.updateVisibleNodes(),setTimeout(async()=>{await e.startAutoLayout()},300)}}},i={};var p=s(c,r,l,!1,d,"681c82ff",null,null);function d(e){for(let o in i)this[o]=i[o]}const h=function(){return p.exports}();export{h as default};
