import{n as N,V as g,j as C}from"./index-3f3d9b78.js";var I=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticStyle:{height:"100vh"}},[e("RelationGraph",{ref:"mixLayoutGraphRef",attrs:{options:t.graphOptions,"on-node-click":t.onNodeClick,"on-line-click":t.onLineClick,"on-node-expand":t.onNodeExpand,"on-node-collapse":t.onNodeCollapse},scopedSlots:t._u([{key:"canvas-plug",fn:function(){return[e("div",{staticStyle:{position:"absolute",left:"0px",top:"-100px",width:"530px","text-align":"center"}},[e("h1",[t._v(t._s(t.graphObj)+"相关产业链图谱")])]),e("div",{staticStyle:{position:"absolute",left:"0px",top:"0px"}},[e("div",{staticClass:"ic-bg"},[e("div",{staticClass:"ic-col"},[e("div",{staticClass:"ic-group-header"},[e("div",{staticClass:"ic-group-name",staticStyle:{"background-color":"rgba(40, 120, 255, 0.08)"}},[t._v("上游 "),t.suffixWords.upList?e("p",[t._v(t._s(t.suffixWords.upList))]):t._e()])]),e("div",{staticClass:"ic-group-body",staticStyle:{"background-color":"rgba(40, 120, 255, 0.08)"}},[t._l(t.allGroups.filter(function(o){return o.colName==="c1"}),function(o){return[e("div",{key:o.myGroupId,staticClass:"ic-group-item",staticStyle:{"background-color":"rgba(40, 120, 255, 1)"},attrs:{id:`root-for-${o.myGroupId}`},on:{click:function(a){return t.onNodeClick(o)}}},[t._v(t._s(o.groupName))])]})],2)]),e("div",{staticClass:"ic-col"},[e("div",{staticClass:"ic-group-header"},[e("div",{staticClass:"ic-group-name",staticStyle:{"background-color":"rgba(255, 168, 38, 0.08)"}},[t._v("中游 "),t.suffixWords.middleList?e("p",[t._v(t._s(t.suffixWords.middleList))]):t._e()])]),e("div",{staticClass:"ic-group-body",staticStyle:{"background-color":"rgba(255, 168, 38, 0.08)"}},[t._l(t.allGroups.filter(function(o){return o.colName==="c2"}),function(o){return[e("div",{key:o.myGroupId,staticClass:"ic-group-item",staticStyle:{"background-color":"rgba(255, 168, 38, 1)"},attrs:{id:`root-for-${o.myGroupId}`},on:{click:function(a){return t.onNodeClick(o)}}},[t._v(t._s(o.groupName))])]})],2)]),e("div",{staticClass:"ic-col"},[e("div",{staticClass:"ic-group-header"},[e("div",{staticClass:"ic-group-name",staticStyle:{"background-color":"rgba(51, 204, 153, 0.08)"}},[t._v("下游 "),t.suffixWords.downList?e("p",[t._v(t._s(t.suffixWords.downList))]):t._e()])]),e("div",{staticClass:"ic-group-body",staticStyle:{"background-color":"rgba(51, 204, 153, 0.08)"}},[t._l(t.allGroups.filter(function(o){return o.colName==="c3"}),function(o){return[e("div",{key:o.myGroupId,staticClass:"ic-group-item",staticStyle:{"background-color":"rgba(51, 204, 153, 1)"},attrs:{id:`root-for-${o.myGroupId}`},on:{click:function(a){return t.onNodeClick(o)}}},[t._v(t._s(o.groupName))])]})],2)])])])]},proxy:!0},{key:"node",fn:function(o){var a=o.node;return[a.data.myGroupId==="my-group-4"?e("div",{staticClass:"my-group-4 c-valign-center"},[t._v(" "+t._s(a.text)+" ")]):t._e()]}},{key:"tool-bar",fn:function(){return[e("div",{staticClass:"tool-bars"},[e("div",{staticClass:"tool-bars-item",attrs:{title:"查看产业链对应机构"},on:{click:t.showDrawer}},[t._v(" xxxx ")])])]},proxy:!0}])})],1)},G=[];const b='{"upList":[{"id":"无人机_15","text":"零部件","rootId":"无人机_0","rootName":"无人机","canClick":true,"content":"材料/部件","children":[{"id":"无人机_26","text":"电子元器件","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_37","text":"电池","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_39","text":"燃料电池","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_40","text":"氢燃料电池","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_38","text":"锂电池","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_41","text":"传感器","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_47","text":"图像传感器","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_48","text":"COMS传感器","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_49","text":"CCD传感器","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_42","text":"陀螺仪","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_46","text":"激光陀螺仪","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_45","text":"九轴陀螺仪","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_44","text":"六轴陀螺仪","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_43","text":"三轴陀螺仪","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_55","text":"GNSS","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_50","text":"加速计","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_53","text":"气压计","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_51","text":"红外传感器","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_56","text":"空速计","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_52","text":"磁罗盘","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_54","text":"磁力计","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_27","text":"芯片","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_34","text":"通信芯片","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_36","text":"基带芯片","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_35","text":"射频芯片","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_28","text":"主控芯片","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_31","text":"MPU","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_29","text":"MCU","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_30","text":"SOC","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_33","text":"DSP","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_32","text":"FPGA","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]}]}]},{"id":"无人机_21","text":"电动机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_22","text":"直流电机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_23","text":"无刷直流电机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_24","text":"步进电机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_25","text":"伺服电机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_16","text":"机体结构件","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_17","text":"起落架","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_19","text":"机身","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_18","text":"机翼","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_20","text":"螺旋桨","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]}]},{"id":"无人机_57","text":"飞行平台分系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"content":"材料/部件","children":[{"id":"无人机_58","text":"动力系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_59","text":"燃油发动机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_60","text":"喷气式发动机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_61","text":"活塞式发动机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_62","text":"电驱动系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_72","text":"其他航空电子系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_76","text":"告警系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_77","text":"数据处理","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_78","text":"任务计算","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_73","text":"光电系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_74","text":"数据链路","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_75","text":"目标识别","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_66","text":"飞行保障系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_69","text":"液压系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_67","text":"电源系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_68","text":"燃油系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_70","text":"环境控制系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_71","text":"机轮刹车系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_65","text":"机载通信系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_63","text":"飞行控制系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_64","text":"机载导航系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_2","text":"原材料","rootId":"无人机_0","rootName":"无人机","canClick":true,"content":"材料/部件","children":[{"id":"无人机_9","text":"复合材料","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_10","text":"纤维复合材料","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_13","text":"玻璃纤维","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_11","text":"碳纤维增强塑料","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_12","text":"芳纶纤维","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_14","text":"陶瓷基复合材料","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_6","text":"橡胶塑料","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_8","text":"橡胶","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_7","text":"EPP泡沫塑料","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_3","text":"金属材料","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_4","text":"铝合金","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_5","text":"钛合金","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]}]},{"id":"无人机_79","text":"任务载荷","rootId":"无人机_0","rootName":"无人机","canClick":true,"content":"材料/部件","children":[{"id":"无人机_92","text":"其他任务载荷","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_93","text":"农药播撒系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_80","text":"摄像系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_81","text":"航摄相机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_82","text":"航摄仪","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_83","text":"高光谱成像仪","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_84","text":"雷达系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_86","text":"相控阵雷达","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_85","text":"激光雷达","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_87","text":"武器系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_88","text":"武器制导系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_89","text":"机载弹仓","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_90","text":"机载导弹","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_91","text":"电子对抗系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]}],"middleList":[{"id":"无人机_111","text":"地面设备","rootId":"无人机_0","rootName":"无人机","canClick":true,"content":"整机/系统","children":[{"id":"无人机_112","text":"遥控检测系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_114","text":"地面站系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_115","text":"显示控制系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_116","text":"信号中继系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_117","text":"遥控台","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_113","text":"遥控器","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_118","text":"起飞着陆系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_95","text":"无人机研制","rootId":"无人机_0","rootName":"无人机","canClick":true,"content":"整机/系统","children":[{"id":"无人机_103","text":"工业无人机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_106","text":"测绘无人机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_108","text":"消防无人机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_109","text":"物流无人机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_107","text":"娱乐观光无人机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_110","text":"科研遥感无人机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_105","text":"巡检无人机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_104","text":"农保无人机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_97","text":"军用无人机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_101","text":"察打一体无人机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_99","text":"攻击无人机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_102","text":"其他辅助无人机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_98","text":"侦察无人机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_100","text":"通讯与电战无人机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_96","text":"消费级无人机","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_119","text":"反无人机系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"content":"整机/系统","children":[{"id":"无人机_124","text":"硬杀伤系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_126","text":"飞弹杀伤","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_125","text":"激光杀伤","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_120","text":"软杀伤系统","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[{"id":"无人机_121","text":"电磁干扰","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_123","text":"飞网捕捉","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_122","text":"系统劫持","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]}]}],"downList":[{"id":"无人机_133","text":"场景应用","rootId":"无人机_0","rootName":"无人机","canClick":true,"content":"服务&应用","children":[{"id":"无人机_136","text":"环境监测","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_137","text":"地理测绘","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_134","text":"农业植保","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_140","text":"娱乐表演","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_139","text":"防卫安保","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_135","text":"巡查应急","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_138","text":"物流运输","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]},{"id":"无人机_128","text":"售后服务","rootId":"无人机_0","rootName":"无人机","canClick":true,"content":"服务&应用","children":[{"id":"无人机_131","text":"维修服务","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_129","text":"技术支持","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_132","text":"设备租赁","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]},{"id":"无人机_130","text":"飞行培训","rootId":"无人机_0","rootName":"无人机","canClick":true,"children":[]}]}]}',l=JSON.parse(b);console.log("jsonData:",l);const v={debug:!1,layouts:[{layoutName:"fixed"}],toolBarDirection:"v",toolBarPositionH:"left",toolBarPositionV:"center",defaultPloyLineRadius:10,defaultNodeFontColor:"#333333",allowShowRefreshButton:!1,allowShowDownloadButton:!1,defaultNodeShape:1,defaultLineShape:3,defaultJunctionPoint:"ltrb",defaultNodeBorderWidth:0,defaultLineColor:"rgba(0, 186, 189, 0.7)",defaultNodeColor:"rgba(0, 206, 209, 0.7)"},S={props:{graphObj:{type:String,default:""},industryData:{type:Object,default:()=>({})}},data(){return{suffixWords:{upList:"",middleList:"",downList:""},needMask:!1,allGroups:[],defaultExpandDeep:1,checkedGroupId:"",graphOptions:v,affiliationsVisible:!1,affiliationList:[],downNum:0}},mounted(){this.loadDataFromRemote()},beforeDestroy(){clearInterval(this.randomTimer)},methods:{turnToAffiliation(t){window.open(`/company/${t.id}`,"_blank")},moreAffiliation(){this.$router.push(`/search/company?keywords=${this.$route.query.type}`)},showDrawer(){this.affiliationsVisible=!this.affiliationsVisible},getAllAffiliations(){this.affiliationList=[]},async loadDataFromRemote(){var c,_,r,h,s;console.log("jsonData",l),this.suffixWords={upList:((c=l.upList)==null?void 0:c.length)>0?l.upList[0].content??"":"",middleList:((_=l.middleList)==null?void 0:_.length)>0?l.middleList[0].content??"":"",downList:((r=l.downList)==null?void 0:r.length)>0?l.downList[0].content??"":""},console.log("this.suffixWords",this.suffixWords),this.downNum=l.downList?(s=(h=l.downList[0])==null?void 0:h.children)==null?void 0:s.length:0;const t=l.upList?l.upList:[],n=l.middleList?l.middleList:[],e=l.downList?l.downList:[],o=this.buildCol1Groups("c1",t,"rgba(40, 120, 255, 0.2)"),a=this.buildCol2Groups("c2",n,"rgba(255, 168, 38, 0.2)");a.length>0&&o.length>0&&a[0].defaultSetting.refs.push(o[o.length-1].myGroupId);const i=this.buildCol3Groups("c3",e,"rgba(51, 204, 153, 0.2)");console.log("cols1Groups",o),console.log("cols2Groups",a),console.log("cols3Groups",i),a.length>1&&i.length>0&&a[a.length-1].defaultSetting.refs.push(i[i.length-1].myGroupId);const d=[...o,...a,...i];await this.showGraph(d,this),console.log("allGroups",this.allGroups)},buildCol1Groups(t,n,e){const o=[];return n.length===1?o.push(this.transToGraphData(t,t+"0",n[0],{node:{color:e,width:100,junctionPoint:"lr",expandHolderPosition:"left"},line:{lineShape:4,color:e},layoutSetting:{layoutExpansionDirection:"top",from:"right"},refs:[]})):n.forEach((a,i)=>{console.log("rootNode------",a),o.push(this.transToGraphData(t,t+"-"+i,a,{rootIndexOfCol:i,node:{color:e,width:100,junctionPoint:"lr",expandHolderPosition:"left"},line:{lineShape:4,color:e},layoutSetting:{from:"right",layoutExpansionDirection:["bottom","top","top","top","top","top","top"][n.length-1-i],min_per_width:[][i],levelDistance:[][i],alignItems:[][i]},refs:[]}))}),o.forEach((a,i)=>{i<o.length-2&&(console.log("set link:",a.myGroupId," parent: ",o[i+1].myGroupId),a.defaultSetting.refs.push(o[i+1].myGroupId))}),o},buildCol2Groups(t,n,e){const o=[];if(n.length===1){const a=n[0];o.push(this.transToGraphData(t,t+"0",a,{node:{color:e,width:100,junctionPoint:"tb",expandHolderPosition:"bottom"},line:{lineShape:4,color:e},layoutSetting:{layoutExpansionDirection:"bottom",from:"top",levelDistance:[this.downNum*25<220?280:this.downNum*25,100,100,100,100,100,100,100,100]},refs:[]}))}else n.forEach((a,i)=>{const d=a;o.push(this.transToGraphData(t,t+"-"+i,d,{rootIndexOfCol:i,node:{color:e,width:100,junctionPoint:["lr","tb","tb","tb","tb","tb","tb"][i],expandHolderPosition:["left","bottom","bottom","bottom","bottom","bottom","bottom"][i]},line:{lineShape:4,color:e},layoutSetting:{from:["right","top","top","top","top","top","top"][i],layoutExpansionDirection:["bottom","right","right","right","right","right","right"][i],min_per_width:[200,110,110,110,110,110,110,110][i],min_per_height:[40,100,100,100,100,100,100,100][i],levelDistance:[][i],alignItems:[][i]},refs:[]}))});return o.forEach((a,i)=>{i>0&&i<o.length-1&&a.defaultSetting.refs.push(o[i+1].myGroupId)}),o},buildCol3Groups(t,n,e){const o=[];return n.length===1?o.push(this.transToGraphData(t,t+"-0",n[0],{node:{color:e,width:100,junctionPoint:"lr",expandHolderPosition:"right"},line:{lineShape:4,color:e},layoutSetting:{layoutExpansionDirection:"center",from:"left"},refs:[]})):(n.forEach((a,i)=>{o.push(this.transToGraphData(t,t+"-"+i,a,{rootIndexOfCol:i,node:{color:e,width:100,junctionPoint:["lr","lr","lr","lr","lr","lr","lr"][n.length-1-i],expandHolderPosition:["right","right","right","right","right","right","right"][n.length-1-i]},line:{lineShape:4,color:e},layoutSetting:{from:["left","left","left","left","left","left","left"][n.length-1-i],layoutExpansionDirection:["bottom","top","top","top","top","top","top"][n.length-1-i],max_per_width:[][i],levelDistance:[][i],alignItems:[][i]},refs:[]}))}),o.forEach((a,i)=>{o.length-i>2&&a.defaultSetting.refs.push(o[i+1].myGroupId)})),o},flatNodeData(t,n,e,o,a=0){t.forEach(i=>{const d=i.children,c=d&&d.length>0,_={id:i.id,text:i.text,data:{...i,canClick:i.canClick,hasChildren:c,deep:a}};c&&a>this.defaultExpandDeep&&(_.expanded=!1),e.push(_),n&&o.push({from:n.id,to:i.id,showEndArrow:!n.id.endsWith("-fake")}),c&&this.flatNodeData(d,i,e,o,a+1)})},transToGraphData(t,n,e,o){const a=[],i=[],d={id:e.id+"-fake",text:e.text,canClick:e.canClick,children:!e.children||e.children.length===0?void 0:[e]},c=d.id,_=e.id;return this.flatNodeData([d],null,a,i),a.forEach(r=>{r.data||(r.data={}),r.data.myGroupId=n,r.junctionPoint=o.node.junctionPoint,r.width=o.node.width,r.color=o.node.color,r.className=t+(r.data.canClick?" clickAbleNode":" clickDisbleNode"),r.data.hasChildren&&(r.expandHolderPosition=o.node.expandHolderPosition),(r.id===_||r.id===c)&&(r.width=10,r.height=10,r.text="",r.disableDrag=!0,r.id===c&&(r.opacity=0),t==="c2"&&r.id===c&&(r.offset_y=-500),t==="c3"&&r.id===c&&(r.width=100,r.alignItems="left"),r.id===c&&(r.expandHolderPosition="hide")),r.children=void 0}),i.forEach((r,h)=>{r.lineShape=o.line.lineShape,r.color=o.line.color,t==="c1"&&h===0&&(r.polyLineStartDistance=30+o.rootIndexOfCol*15),t==="c2"&&h===0&&(r.fromJunctionPoint="left",r.toJunctionPoint="left",r.polyLineStartDistance=(4-o.rootIndexOfCol)*15),t==="c3"&&h===0&&(r.fromJunctionPoint="right",r.toJunctionPoint="left",r.polyLineStartDistance=30+o.rootIndexOfCol*15)}),{colName:t,groupName:e.text,myGroupId:n,fakeRootNodeId:c,rootNodeId:_,defaultSetting:o,nodes:a,lines:i,data:e}},async showGraph(t,n=this){var a;if(!((a=this==null?void 0:this.$refs)!=null&&a.mixLayoutGraphRef))return;const e={rootId:"my-root",nodes:[{id:"my-root",text:"根节点",opacity:0}],lines:[],elementLines:[]},o=this.$refs.mixLayoutGraphRef.getInstance();o.loading("Wait...");for(const i of t){const{defaultSetting:d,rootNodeId:c,nodes:_,lines:r}=i;e.nodes.push(..._),e.lines.push(...r),i.nodes=null,i.lines=null}this.allGroups=t,await o.setJsonData(e);for(const i of t)await this.layoutGroup(i,0);await o.moveToCenter(),await o.zoomToFit(),o.clearLoading()},getElementPosition(t,n){const o=document.getElementById(n).getBoundingClientRect(),a=t.$canvasDom.getBoundingClientRect(),i=(o.x-a.x)/(t.options.canvasZoom/100),d=(o.y-a.y)/(t.options.canvasZoom/100);return{x:i,y:d}},getDeepPrefix(t){return["","    ","        -","            -","                -","                    -","                        -","                            -"][t]},async layoutGroup(t,n=0,e=-1){console.log("relayout:",t.myGroupId);const{defaultSetting:o,fakeRootNodeId:a,rootNodeId:i,myGroupId:d}=t,c=this.$refs.mixLayoutGraphRef.getInstance(),_="root-for-"+d,r=this.getElementPosition(c,_),h=c.getNodes().filter(u=>u.data&&u.data.myGroupId===d),s=c.getNodeById(a);s.x=r.x,s.y=r.y+10;const f={layoutName:"tree",from:"right",layoutExpansionDirection:"top",max_per_width:200,max_per_height:40};if(o.layoutSetting.from&&(f.from=o.layoutSetting.from),o.layoutSetting.layoutExpansionDirection&&(f.layoutExpansionDirection=o.layoutSetting.layoutExpansionDirection),o.layoutSetting.min_per_width&&(f.min_per_width=o.layoutSetting.min_per_width,f.max_per_width=o.layoutSetting.min_per_width),o.layoutSetting.min_per_height&&(f.min_per_height=o.layoutSetting.min_per_height,f.max_per_height=o.layoutSetting.min_per_height),o.layoutSetting.levelDistance&&(f.levelDistance=o.layoutSetting.levelDistance),o.layoutSetting.alignItems&&h.forEach(u=>{u.alignItems=o.layoutSetting.alignItems}),h.forEach(u=>{u.data.hasChildren&&e!==-1&&(u.data.deep>e?u.expanded=!1:u.expanded=!0)}),s.x=r.x+4,s.y=r.y+10,t.defaultSetting.refs.length>0){const u=t.defaultSetting.refs[0],m=this.allGroups.find(y=>y.myGroupId===u);m.layouted||await this.layoutGroup(m,n+1);const p=this.analyzeGroupNodes(u);console.log(t.myGroupId," parent:",u,m.defaultSetting.layoutSetting.layoutExpansionDirection,t.colName),m.defaultSetting.layoutSetting.layoutExpansionDirection==="top"&&(s.offset_y=r.y-p.minY+45),m.defaultSetting.layoutSetting.layoutExpansionDirection==="top"&&t.colName==="c2"&&(s.offset_y=p.maxY-Math.abs(p.minY)>60?p.maxY-Math.abs(p.minY)-70:p.maxY-Math.abs(p.minY)),m.defaultSetting.layoutSetting.layoutExpansionDirection==="bottom"&&m.colName==="c1"&&(s.offset_y=r.y-p.maxY-45),m.defaultSetting.layoutSetting.layoutExpansionDirection==="right"&&(s.offset_y=r.y-p.maxY+45),m.defaultSetting.layoutSetting.layoutExpansionDirection==="bottom"&&m.colName==="c3"&&(s.offset_y=r.y-p.maxY+45)}console.log("------root offset_y:",s.offset_y);const x=g.createLayout(f,c.options,c);x.isMainLayouer=!1,x.layoutOptions.fixedRootNode=!0,await x.placeNodes(h,s),t.layouted=!0,this.analyzeGroupNodes(d)},analyzeGroupNodes(t){const{RGNodesAnalytic:n}=C,a=this.$refs.mixLayoutGraphRef.getInstance().getNodes().filter(c=>c.data&&c.data.myGroupId===t).filter(c=>n.isAllowShowNode(c));let i=-99999,d=99999;for(const c of a)c.y<d&&(d=c.y),c.y>i&&(i=c.y);return{maxY:i,minY:d}},onNodeClick(t,n){t.data.canClick&&this.$emit("nodeClick",t)},onLineClick(t,n,e){},async onNodeExpand(t,n){this.relayoutIfNeed(t)},async onNodeCollapse(t,n){this.relayoutIfNeed(t)},async relayoutIfNeed(t){const n=this.allGroups.find(e=>e.myGroupId===t.data.myGroupId);await this.layoutGroup(n),await this.relayoutAffectedGroups(n)},async relayoutAffectedGroups(t){const n=this.allGroups.filter(e=>e.defaultSetting.refs.includes(t.myGroupId));for(const e of n)console.log("relayout:refs",t.myGroupId," ---> ",e.myGroupId),await this.layoutGroup(e),await this.relayoutAffectedGroups(e)},checkGroup(t){this.checkedGroupId=t},async openByDeep(t){const n=this.allGroups.find(e=>e.myGroupId===this.checkedGroupId);await this.layoutGroup(n,0,t),await this.relayoutAffectedGroups(n)}}},k={};var w=N(S,I,G,!1,L,"ba367f38",null,null);function L(t){for(let n in k)this[n]=k[n]}const E=function(){return w.exports}();export{E as default};
