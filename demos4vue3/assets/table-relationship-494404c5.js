import{M as C}from"./relation-graph-de73bd62.js";import{d as v,r as x,o as L,a as s,c as S,b as e,e as U,w as _,u as M,t as c,F as P,g as k,p as w,j as D,f as d}from"./index-e1681cb0.js";import{_ as I}from"./_plugin-vue_export-helper-c27b6911.js";const N=m=>(w("data-v-e0070ff9"),m=m(),D(),m),J={style:{height:"calc(100vh - 60px)"}},A=N(()=>e("div",{style:{"z-index":"300",position:"absolute",left:"10px",top:"calc(100% - 50px)","font-size":"12px","background-color":"#ffffff",border:"#efefef solid 1px","border-radius":"10px",width:"260px",height:"40px",display:"flex","align-items":"center","justify-content":"center"}},[d(" Legendï¼š "),e("div",null,[d(" More to one "),e("div",{style:{height:"5px",width:"80px","background-color":"rgba(159,23,227,0.65)"}})]),e("div",{style:{"margin-left":"10px"}},[d(" One to one "),e("div",{style:{height:"5px",width:"80px","background-color":"rgba(29,169,245,0.76)"}})])],-1)),B={style:{width:"300px","background-color":"#f39930"}},V={class:"c-data-table"},$=N(()=>e("tr",null,[e("th",null,"Column Name"),e("th",null,"Data Type")],-1)),j=["id"],z=v({__name:"table-relationship",setup(m){const i=x(null),p={debug:!1,allowSwitchLineShape:!0,allowSwitchJunctionPoint:!0,allowShowDownloadButton:!0,defaultJunctionPoint:"border",placeOtherNodes:!1,placeSingleNode:!1,graphOffset_x:-200,graphOffset_y:100,defaultLineMarker:{markerWidth:20,markerHeight:20,refX:3,refY:3,data:"M 0 0, V 6, L 4 3, Z"},layout:{layoutName:"fixed"}};L(()=>{E()});const E=async()=>{var u;const o=[{tableName:"SYS_USER",tableComents:"SYS_USER comments",x:500,y:-300},{tableName:"SYS_DEPT",tableComents:"SYS_DEPT comments",x:0,y:-300},{tableName:"SYS_ROLE",tableComents:"SYS_ROLE comments",x:0,y:0},{tableName:"SYS_USER_ROLE",tableComents:"SYS_USER_ROLE comments",x:500,y:0},{tableName:"SYS_RESOURCE",tableComents:"SYS_RESOURCE comments",x:0,y:300},{tableName:"SYS_ROLE_RESOURCE",tableComents:"SYS_ROLE_RESOURCE comments",x:500,y:300}],n=[{tableName:"SYS_USER",columnName:"id",dataType:"varchar(36)"},{tableName:"SYS_USER",columnName:"user_name",dataType:"varchar(50)"},{tableName:"SYS_USER",columnName:"dept_id",dataType:"varchar(36)"},{tableName:"SYS_USER",columnName:"create_time",dataType:"TIMESTAMP"},{tableName:"SYS_USER",columnName:"status",dataType:"varchar(1)"},{tableName:"SYS_DEPT",columnName:"id",dataType:"varchar(36)"},{tableName:"SYS_DEPT",columnName:"dept_name",dataType:"varchar(50)"},{tableName:"SYS_DEPT",columnName:"parent_dept_id",dataType:"varchar(50)"},{tableName:"SYS_DEPT",columnName:"create_time",dataType:"TIMESTAMP"},{tableName:"SYS_DEPT",columnName:"status",dataType:"varchar(50)"},{tableName:"SYS_ROLE",columnName:"id",dataType:"varchar(36)"},{tableName:"SYS_ROLE",columnName:"role_name",dataType:"varchar(36)"},{tableName:"SYS_ROLE",columnName:"create_time",dataType:"TIMESTAMP"},{tableName:"SYS_USER_ROLE",columnName:"id",dataType:"varchar(36)"},{tableName:"SYS_USER_ROLE",columnName:"user_id",dataType:"varchar(36)"},{tableName:"SYS_USER_ROLE",columnName:"role_id",dataType:"varchar(36)"},{tableName:"SYS_USER_ROLE",columnName:"create_time",dataType:"TIMESTAMP"},{tableName:"SYS_USER_ROLE",columnName:"status",dataType:"varchar(36)"},{tableName:"SYS_RESOURCE",columnName:"id",dataType:"varchar(36)"},{tableName:"SYS_RESOURCE",columnName:"resource_name",dataType:"varchar(36)"},{tableName:"SYS_RESOURCE",columnName:"create_time",dataType:"TIMESTAMP"},{tableName:"SYS_ROLE_RESOURCE",columnName:"id",dataType:"varchar(36)"},{tableName:"SYS_ROLE_RESOURCE",columnName:"role_id",dataType:"varchar(36)"},{tableName:"SYS_ROLE_RESOURCE",columnName:"resource_id",dataType:"varchar(36)"},{tableName:"SYS_ROLE_RESOURCE",columnName:"status",dataType:"varchar(1)"}],t=[{sourceTableName:"SYS_USER",sourceColumnName:"dept_id",type:"MORE_TO_ONE",targetTableName:"SYS_DEPT",targetColumnName:"id"},{sourceTableName:"SYS_DEPT",sourceColumnName:"parent_dept_id",type:"ONE_TO_ONE",targetTableName:"SYS_DEPT",targetColumnName:"id"},{sourceTableName:"SYS_USER_ROLE",sourceColumnName:"user_id",type:"MORE_TO_ONE",targetTableName:"SYS_USER",targetColumnName:"id"},{sourceTableName:"SYS_USER_ROLE",sourceColumnName:"role_id",type:"MORE_TO_ONE",targetTableName:"SYS_ROLE",targetColumnName:"id"},{sourceTableName:"SYS_ROLE_RESOURCE",sourceColumnName:"role_id",type:"MORE_TO_ONE",targetTableName:"SYS_ROLE",targetColumnName:"id"},{sourceTableName:"SYS_ROLE_RESOURCE",sourceColumnName:"resource_id",type:"MORE_TO_ONE",targetTableName:"SYS_RESOURCE",targetColumnName:"id"}],l=o.map(a=>{const{tableName:O,tableComents:y,x:f,y:g}=a;return{id:O,text:y,x:f,y:g,nodeShape:1,data:{columns:n.filter(Y=>Y.tableName===a.tableName)}}}),h=t.map(a=>({from:a.sourceTableName+"-"+a.sourceColumnName,to:a.targetTableName+"-"+a.targetColumnName,color:a.type==="ONE_TO_ONE"?"rgba(29,169,245,0.76)":"rgba(159,23,227,0.65)",text:"",fromJunctionPoint:"left",toJunctionPoint:"lr",lineShape:6,lineWidth:3})),T={nodes:l,lines:[],elementLines:h},r=(u=i.value)==null?void 0:u.getInstance();r&&(await r.setJsonData(T),await r.moveToCenter(),await r.zoomToFit())},R=(o,n)=>{console.log("onNodeClick:",o)},b=(o,n,t)=>{console.log("onLineClick:",o)};return(o,n)=>(s(),S("div",null,[e("div",J,[U(M(C),{ref_key:"graphRef",ref:i,options:p,"on-node-click":R,"on-line-click":b},{"graph-plug":_(()=>[A]),"canvas-plug":_(()=>[]),node:_(({node:t})=>[e("div",B,[e("div",null,c(t.text)+" - "+c(t.data.columns.length)+" Cols",1),e("table",V,[$,(s(!0),S(P,null,k(t.data.columns,l=>(s(),S("tr",{key:l.columnName},[e("td",null,[e("div",{id:`${t.id}-${l.columnName}`},c(l.columnName),9,j)]),e("td",null,c(l.dataType),1)]))),128))])])]),_:1},512)])]))}});const H=I(z,[["__scopeId","data-v-e0070ff9"]]);export{H as default};
