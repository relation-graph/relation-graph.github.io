import{k as z}from"./relation-graph-4b768e87.js";import W from"./VipMyGraphToolBar-7d7fc1d2.js";import{d as H,r as s,v as X,o as $,a as i,c as r,l as K,e as L,w as J,u as Q,m as Z,E as v,n as ee,b as x,t as g,q as u,I as te,p as oe,j as ae}from"./index-ee818b67.js";import{_ as ne}from"./_plugin-vue_export-helper-c27b6911.js";import"./CircumIcons-dd916674.js";const S=h=>(oe("data-v-6673812d"),h=h(),ae(),h),se={style:{height:"calc(100vh - 50px)"},"element-loading-text":"Checking your login status..."},ie={class:"c-object-info"},re=S(()=>x("div",null,"Current right-click event information:",-1)),de={key:0},ce={key:1},le={key:2},ue=S(()=>x("div",null,"You can perform the following operations on this object:",-1)),pe=H({__name:"my-graph-app",setup(h){const N={rootId:"2",nodes:[{id:"1",text:"Node-1"},{id:"2",text:"Node-2"},{id:"3",text:"Node-3"},{id:"4",text:"Node-4"},{id:"6",text:"Node-6"},{id:"7",text:"Node-7"},{id:"8",text:"Node-8"},{id:"9",text:"Node-9"},{id:"71",text:"Node-71"},{id:"72",text:"Node-72"},{id:"73",text:"Node-73"},{id:"81",text:"Node-81"},{id:"82",text:"Node-82"},{id:"83",text:"Node-83"},{id:"84",text:"Node-84"},{id:"85",text:"Node-85"},{id:"91",text:"Node-91"},{id:"92",text:"Node-82"},{id:"5",text:"Node-5"}],lines:[{from:"7",to:"71",text:"Investment"},{from:"7",to:"72",text:"Investment"},{from:"7",to:"73",text:"Investment"},{from:"8",to:"81",text:"Investment"},{from:"8",to:"82",text:"Investment"},{from:"8",to:"83",text:"Investment"},{from:"8",to:"84",text:"Investment"},{from:"8",to:"85",text:"Investment"},{from:"9",to:"91",text:"Investment"},{from:"9",to:"92",text:"Investment"},{from:"1",to:"2",text:"Investment"},{from:"3",to:"1",text:"Executive"},{from:"4",to:"2",text:"Executive"},{from:"6",to:"2",text:"Executive"},{from:"7",to:"2",text:"Executive"},{from:"8",to:"2",text:"Executive"},{from:"9",to:"2",text:"Executive"},{from:"1",to:"5",text:"Investment"}]},E={disableDragLine:!1,allowSwitchLineShape:!0,allowSwitchJunctionPoint:!0,allowShowDownloadButton:!0,defaultJunctionPoint:"border",layout:{layoutName:"center"}},T={debug:!1,disableDragLine:!1,allowSwitchLineShape:!0,allowSwitchJunctionPoint:!0,allowShowDownloadButton:!0,defaultJunctionPoint:"border",defaultExpandHolderPosition:"right",layout:{layoutName:"fixed"}},d=s(!1),y=s(!1),p=s({x:0,y:0}),c=s(null),l=s(""),P=s(1),B=s(1),_=s(!0),f=s(!1),w=s(""),m=s(),G=X(()=>m.value&&m.value.account||""),j=async()=>{await v({title:"Tip:",message:"This is an example that allows you to modify and save the graph, and restore the saved state when opened again.",type:"success",duration:2e4}),m.value?(w.value=m.value.userId+"-my-demo",await M(w.value)):(await v({title:"This example requires you to log in",message:"This example requires you to log in to demonstrate saving and restore the state when opened again.",type:"success",duration:2e4}),await I(N))},M=async o=>{const e=await O(o);if(!e)await v({title:"You are opening the graph for the first time",message:"You have not saved this graph before, so the default data is displayed and the data will be assigned positions by the layouter.",type:"success",duration:2e4}),await I(N);else{await v({title:"Display the saved graph state",message:"You have saved this graph before, and now restore the data state you saved before.",type:"success",duration:2e4});const t=d.value.getInstance();await t.setOptions(T),await I(e),await t.moveToCenter(),await t.zoomToFit()}},O=async o=>{const e=await k("/my-graph/get-graph",{docId:o,ignoreErrors:!0});if(e.data&&e.data.data){const t=e.data.data,{docContent:a}=t;console.log("graphInfo:",t);const n=JSON.parse(a);return console.log("graphJsonData.jsonData:",n.jsonData),console.log("graphJsonData.options:",n.options),n.jsonData}else return null},I=async o=>{await d.value.getInstance().setJsonData(o,async t=>{})},R=async()=>{if(!G.value){await v({title:"Please log in first",message:"This example requires you to log in to demonstrate saving and restore the state when opened again.",type:"success",duration:2e4});return}if(f.value)return;f.value=!0,setTimeout(()=>{f.value=!1},15e3);const e=d.value.getInstance().getGraphJsonData(),t=await k("/my-graph/save-graph",{docId:w.value,name:"My demo graph",docContent:JSON.stringify({options:void 0,jsonData:e})});f.value=!1;const a=t.data.data;if(console.log("saveResult:",a),!a.updated){te({type:"info",message:a.message});return}await v({title:"Document saved successfully!",message:"You can try refreshing the page to access this graph again, and it will restore the data state you saved.",type:"success",duration:2e4})},F=(o,e,t)=>{const a=d.value.getInstance();c.value=e,l.value=t;const n=a.getBoundingClientRect();console.log("showNodeMenus:",o,n),y.value=!0,p.value.x=o.clientX-n.x+10,p.value.y=o.clientY-n.y+10;const b=()=>{y.value=!1,document.body.removeEventListener("click",b)};document.body.addEventListener("click",b)},Y=o=>{const e=d.value.getInstance(),t=e.getBoundingClientRect(),a=e.getCanvasCoordinateByClientCoordinate({x:p.value.x-10+t.x,y:p.value.y-10+t.y}),n=P.value++;e.addNodes([{id:"addFromCanvas-"+n,text:"New-"+n,color:"#5da0f8",x:a.x,y:a.y}])},V=o=>{d.value.getInstance().removeNodeById(l.value.id)},q=o=>{d.value.getInstance().removeLinkById(l.value.seeks_id)},A=o=>{const e=d.value.getInstance();e.startCreatingLinePlot(o,{template:{lineWidth:3,color:"#e85f84",text:"New Link"},fromNode:l.value,onCreateLine:(t,a)=>{if(console.log("New Link:",t,a),a.id){const n=B.value++;e.addLines([{from:t.id,to:a.id,lineWidth:3,color:"#e85f84",text:"New Link"+n}])}}})},k=async(o,e)=>new Promise((t,a)=>{window.top.postMessage({action:"postJson",url:o,data:e},D),C=n=>{t(n)}});let C;const U=async o=>{console.log("Vue3:event.data:",o.origin,o.data);const{action:e,data:t}=o.data;e==="returnPostJson"?C(t):e==="setUserInfo"&&(m.value=t,_.value=!1,j())};$(()=>{window.addEventListener("message",U),setTimeout(()=>{window.top.postMessage({action:"getUserInfo"},D)},2e3)});const D=window.origin;return(o,e)=>{const t=Z("loading");return i(),r("div",null,[K((i(),r("div",se,[L(Q(z),{ref_key:"graphRef",ref:d,options:E,"on-contextmenu":F},{"tool-bar":J(()=>[L(W,{"on-save":R})]),"graph-plug":J(()=>[y.value?(i(),r("div",{key:0,style:ee({left:p.value.x+"px",top:p.value.y+"px"}),class:"c-right-menu-panel"},[x("div",ie,[re,x("div",null,"Type: "+g(c.value),1),c.value==="link"?(i(),r("div",de,g(l.value.fromNode.text)+" -> "+g(l.value.toNode.text),1)):u("",!0),c.value==="node"?(i(),r("div",ce,"ID: "+g(l.value.id),1)):u("",!0),c.value==="node"?(i(),r("div",le,"Text: "+g(l.value.text),1)):u("",!0),ue]),c.value==="canvas"?(i(),r("div",{key:0,class:"c-node-menu-item",onClick:Y},"Add Node")):u("",!0),c.value==="node"?(i(),r("div",{key:1,class:"c-node-menu-item",onClick:V},"Delete Node")):u("",!0),c.value==="node"?(i(),r("div",{key:2,class:"c-node-menu-item",onClick:A},"Add Link")):u("",!0),c.value==="link"?(i(),r("div",{key:3,class:"c-node-menu-item",onClick:q},"Delete Link")):u("",!0)],4)):u("",!0)]),_:1},512)])),[[t,_.value]])])}}});const xe=ne(pe,[["__scopeId","data-v-6673812d"]]);export{xe as default};
