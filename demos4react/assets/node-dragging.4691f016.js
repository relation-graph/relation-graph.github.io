import{r as h,a as i,j as d}from"./index.7473cb17.js";import{u as Y,h as w}from"./relation-graph.26f01d58.js";const{RGNodesAnalytic:c}=w,P=()=>{const n=h.exports.useRef(null);h.exports.useEffect(()=>{u()},[]);const g={debug:!1,allowSwitchLineShape:!0,allowSwitchJunctionPoint:!0,allowShowDownloadButton:!0,defaultJunctionPoint:"border",placeOtherNodes:!1,placeSingleNode:!1,graphOffset_x:-200,graphOffset_y:100,defaultNodeColor:"#ffffff",defaultNodeBorderWidth:1,defaultNodeBorderColor:"#f39930",defaultNodeWidth:170,defaultNodeHeight:70,defaultLineColor:"#f39930",defaultLineWidth:2,defaultLineTextOffset_y:-2,layout:{layoutName:"fixed"}},u=async()=>{var e;const o={rootId:"SYS_ROLE",nodes:[{id:"SYS_USER",text:"SYS_USER",nodeShape:1,opacity:1,x:-32,y:-427,width:120,height:80,data:{dropAble:!0}},{id:"SYS_DEPT",text:"SYS_DEPT",nodeShape:0,opacity:1,x:-244,y:-283,data:{dropAble:!0}},{id:"SYS_ROLE",text:"SYS_ROLE",nodeShape:1,opacity:1,x:-21,y:-171,width:300,height:200,data:{allowOverlap:!1}},{id:"SYS_USER_ROLE",text:"SYS_USER_ROLE",nodeShape:1,opacity:1,x:405,y:-174},{id:"SYS_RESOURCE",text:"SYS_RESOURCE",nodeShape:1,opacity:1,x:-246,y:-80,data:{dropAble:!0}},{id:"SYS_ROLE_RESOURCE",text:"SYS_ROLE_RESOURCE",nodeShape:1,opacity:1,x:338,y:-100}],lines:[{from:"SYS_DEPT",to:"SYS_USER",text:"xxxxxxx"},{from:"SYS_DEPT",to:"SYS_USER"},{from:"SYS_DEPT",to:"SYS_USER"},{from:"SYS_DEPT",to:"SYS_USER"},{from:"SYS_DEPT",to:"SYS_USER"},{from:"SYS_DEPT",to:"SYS_USER"}]},a=(e=n.current)==null?void 0:e.getInstance();a&&(await a.setJsonData(o),await a.moveToCenter(),await a.zoomToFit())},x=(o,a,e,r)=>{var p;console.log("onNodeDragging:",o);const t=(p=n.current)==null?void 0:p.getInstance();let s=!1,S;for(const l of(t==null?void 0:t.getNodes())||[]){if(o===l)continue;const y=o.nodeShape||t.options.defaultNodeShape||0,_=l.nodeShape||t.options.defaultNodeShape||0,R={el:o.el,x:a,y:e};if(c.shapesOverlap(R,l,y,_)){let f=l.data.dropAble?"rgba(212,252,189,0.82)":"rgba(252,189,189,0.82)";l.data.allowOverlap===!1&&(s=!0,S=c.getNoOverlapLimitedPosition(o,a,e,l),f="rgba(214,165,246,0.82)"),l.data.orignColorSaved||(l.data.orignColorSaved=!0,l.data.orignColor=l.color),l.color=f}else l.color=void 0}if(s)return S},v=(o,a)=>{console.log("onNodeDragStart:",o),o.data.startX=o.x,o.data.startY=o.y},E=(o,a)=>{var r;console.log("onNodeDragEnd:",o);const e=(r=n.current)==null?void 0:r.getInstance();for(const t of(e==null?void 0:e.getNodes())||[]){if(o===t||t.data.allowOverlap===!1||!t.data.dropAble)continue;const s=o.nodeShape||e.options.defaultNodeShape||0,S=t.nodeShape||e.options.defaultNodeShape||0;if(c.shapesOverlap(o,t,s,S)){N(o,t);break}}for(const t of(e==null?void 0:e.getNodes())||[])t.color=t.data.orignColor},N=(o,a)=>{var r;console.log("updateNodeAsChildren:",a.id,"---->",o.id),o.x=o.data.startX,o.y=o.data.startY;const e=(r=n.current)==null?void 0:r.getInstance();e&&e.addLines([{from:a.id,to:o.id,text:"\u65B0\u8FDE\u7EBF",color:"rgba(214,165,246,0.82)",lineWidth:3}])};return i("div",{children:i("div",{style:{height:"100vh"},onMouseMove:o=>{var a;if(o.target){const e=o.target.tagName;if(e==="path"||e==="text"){const r=(a=n.current)==null?void 0:a.getInstance(),t=r==null?void 0:r.isLink(o.target);t&&console.log("Show Detail:",t.fromNode.id,t.toNode.id)}else console.log("Hide Detail")}},children:i(Y,{ref:n,options:g,onNodeDragging:x,onNodeDragStart:v,onNodeDragEnd:E,onNodeClick:(o,a)=>{console.log("onNodeClick:",o)},onLineClick:(o,a,e)=>{console.log("onLineClick:",o)},graphPlugSlot:({relationGraph:o})=>i("div",{slot:"graph-plug",children:i("div",{style:{zIndex:300,position:"absolute",left:"10px",top:"calc(100% - 140px)",fontSize:"12px",backgroundColor:"#ffffff",border:"#efefef solid 1px",borderRadius:"10px",width:"250px",height:"130px"},children:d("div",{style:{paddingLeft:"10px"},children:[i("div",{style:{lineHeight:"30px"},children:"The color of the moving over node\uFF1A"}),d("div",{style:{marginTop:"10px"},children:["Allowed drop",i("div",{style:{height:"5px",width:"80px",backgroundColor:"rgba(212,252,189,0.82)"}})]}),d("div",{style:{marginTop:"10px"},children:["Not allowed drop",i("div",{style:{height:"5px",width:"80px",backgroundColor:"rgba(252,189,189,0.82)"}})]}),d("div",{style:{marginTop:"10px"},children:["Not allowed to enter",i("div",{style:{height:"5px",width:"80px",backgroundColor:"rgba(214,165,246,0.82)"}})]})]})})}),nodeSlot:({node:o})=>i("div",{children:d("div",{children:[i("div",{className:"bg-yellow-500",children:o.text}),o.id==="SYS_ROLE"&&i("div",{style:{color:"#df7f03",padding:"10px"},children:"Not allowed to enter"})]})})})})})};export{P as default};
