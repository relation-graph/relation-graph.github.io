import{r as i,a as n,j as a}from"./index.7473cb17.js";import{u as V}from"./relation-graph.26f01d58.js";import{MySlider as x,MySelector as j,MyRangeSlider as w,MyLinkButton as y}from"./RGComponentsForDemo.afa6e56e.js";const P=()=>{const r=i.exports.useRef(null),[g,L]=i.exports.useState("node"),[c,_]=i.exports.useState(3e3),[d,v]=i.exports.useState(1),[l,k]=i.exports.useState(1),[u,C]=i.exports.useState([.1,30]),[h,F]=i.exports.useState([.1,4]),m=i.exports.useRef(0),R={debug:!1,defaultNodeBorderWidth:0,allowSwitchLineShape:!0,allowSwitchJunctionPoint:!0,defaultLineShape:1,layout:{layoutName:"force",maxLayoutTimes:3e3,force_node_repulsion:.5,force_line_elastic:.5},defaultJunctionPoint:"border"},b=async()=>{var o;const e={rootId:"root",nodes:[{id:"root",text:"Root",force_weight:600}],lines:[]};for(let s=0;s<30;s++){const p={id:"n"+s,text:""},E={from:e.rootId,to:p.id,text:""};e.nodes.push(p),e.lines.push(E)}const t=(o=r.current)==null?void 0:o.getInstance();await(t==null?void 0:t.setJsonData(e)),f()},S=(e,t)=>{console.log("onNodeClick:",e)},M=(e,t,o)=>{console.log("onLineClick:",e)},f=async()=>{N();const e=r.current.getInstance();e.getNodes().forEach(t=>{if(t===e.graphData.rootNode)return;const o=u[0]+Math.random()*u[1];t.width=10+10*Math.sqrt(o),t.height=10+10*Math.sqrt(o),t.force_weight=o,t.text=o.toFixed(1)}),e.dataUpdated(),await e.doLayout()},T=async()=>{N();const e=r.current.getInstance();e.getLinks().forEach(t=>{const o=t.relations[0],s=h[0]+Math.random()*h[1];o.force_elastic=s,o.text=s.toFixed(1)}),e.dataUpdated()},N=()=>{const e=r.current.getInstance();e.getNodes().forEach(t=>{t!==e.graphData.rootNode&&(t.width=30,t.height=30,t.force_weight=void 0,t.text="")}),e==null||e.getLinks().forEach(t=>{const o=t.relations[0];o.force_elastic=void 0,o.text=""})},A=async()=>{const e=r.current.getInstance();await e.stopAutoLayout();const t=e.layouter.layoutOptions;t.maxLayoutTimes=c,t.force_node_repulsion=d,t.force_line_elastic=l,e.layouter.maxLayoutTimes=c,e.layouter.force_node_repulsion=d,e.layouter.force_line_elastic=l,setTimeout(async()=>{await(e==null?void 0:e.startAutoLayout())},500)},I=async()=>{m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{A()},500)},O=()=>{const e=r.current.getInstance(),t=e.options.checkedNodeId||e.graphData.rootNode.id,o=e.generateNewNodeId(),s=[{id:o+"-1",text:"New node"},{id:o+"-2",text:"New node"}];s.forEach(p=>{p.x=Math.floor(Math.random()*40),p.y=Math.floor(Math.random()*40)}),e.addNodes(s),e.addLines([{from:t,to:o+"-1",text:"New"},{from:t,to:o+"-2",text:"New"}]),e.layouter.allNodes=e.graphData.nodes,e.layouter.allLinks=e.graphData.links,e.layouter.updateVisibleNodes(),setTimeout(async()=>{await(e==null?void 0:e.startAutoLayout())},300)};return i.exports.useEffect(()=>(b(),()=>{var e;(e=r.current)==null||e.getInstance().stopAutoLayout()}),[]),i.exports.useEffect(()=>{I()},[c,d,l]),n("div",{children:a("div",{style:{height:"100vh"},children:[a("div",{className:"c-my-panel rounded-lg absolute left-20 top-20 z-20 p-4 bg-white border-solid border-2 border-black shadow-lg",children:[a("div",{style:{width:"500px"},children:[a("div",{className:"c-option-name",children:["Layout Times: ",c]}),n(x,{currentValue:c,min:10,max:1e3,step:100,onChange:e=>{_(e)}}),a("div",{className:"c-option-name",children:["Node Repulsion Coefficient: ",d," \xA0\xA0\xA0\xA0\uFF08Setting it too large will cause shaking\uFF09"]}),n(x,{currentValue:d,min:.01,step:.05,max:4,onChange:e=>{v(e)}}),a("div",{className:"c-option-name",children:["Line Elastic Coefficient: ",l," \xA0\xA0\xA0\xA0\uFF08Setting it too large will cause shaking\uFF09"]}),n(x,{currentValue:l,min:.01,step:.05,max:4,onChange:e=>{k(e)}})]}),a("div",{className:"border border-gray-500 rounded-lg p-2",children:[n("div",{className:"c-option-name",children:"Observation Object:"}),n("div",{className:"w-36",children:n(j,{data:[{value:"node",text:"Node"},{value:"line",text:"Line"}],currentValue:g,onChange:(e,t)=>{L(e)}})}),a("div",{style:{padding:"5px"},children:[a("div",{style:{display:g==="node"?"block":"none",paddingRight:"10px"},children:[a("div",{className:"c-option-name",children:["Random Range: (",u[0],", ",u[1],")"]}),n(w,{currentValue:u,min:.2,max:30,onChange:e=>{C(e)}}),n(y,{onClick:()=>{f()},children:"Randomly Reset Node Weight"})]}),a("div",{style:{display:g==="line"?"block":"none",paddingRight:"10px"},children:[a("div",{className:"c-option-name",children:["Random Range: (",h[0],", ",h[1],")"]}),n(w,{currentValue:h,min:.2,max:30,onChange:e=>{F(e)}}),n(y,{onClick:()=>{T()},children:"Randomly Reset Line Elastic"})]})]})]}),n("hr",{}),n("div",{style:{padding:"10px"},children:n(y,{onClick:()=>{O()},children:"Add Two Child Nodes to Selected Nodes"})})]}),n(V,{ref:r,options:R,onNodeClick:S,onLineClick:M})]})})};export{P as default};
