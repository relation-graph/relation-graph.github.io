import{r as l,a as n,j as d}from"./index.7473cb17.js";import{u as Q}from"./relation-graph.26f01d58.js";import{I as U}from"./index.e712a3dd.js";const te=()=>{var P;const s=l.exports.useRef(null),[c,m]=l.exports.useState(null),[E,h]=l.exports.useState(!1),[y,I]=l.exports.useState({x:0,y:0}),[C,L]=l.exports.useState(!1),[v,_]=l.exports.useState({x:0,y:0}),[x,w]=l.exports.useState(null),[a,T]=l.exports.useState(null),[z,N]=l.exports.useState(!1),[S,B]=l.exports.useState({x:0,y:0}),[A,R]=l.exports.useState({x:0,y:0}),[F,k]=l.exports.useState(!1),[b,O]=l.exports.useState({defaultLineColor:"auto",defaultNodeColor:"auto",defaultNodeBorderColor:"auto",defaultNodeFontColor:"auto"}),X=async()=>{var o;const e={rootId:"2",nodes:[{id:"1",text:"Node-1",data:{myicon:"star"}},{id:"2",text:"Node-2",data:{myicon:"settings"}},{id:"3",text:"Node-3",data:{myicon:"settings"}},{id:"4",text:"Node-4",data:{myicon:"star"}},{id:"6",text:"Node-6",data:{myicon:"settings"}},{id:"7",text:"Node-7",data:{myicon:"settings"}},{id:"8",text:"Node-8",data:{myicon:"star"}},{id:"9",text:"Node-9",data:{myicon:"headphones"}},{id:"71",text:"Node-71",data:{myicon:"headphones"}},{id:"72",text:"Node-72",data:{myicon:"bluetooth"}},{id:"73",text:"Node-73",data:{myicon:"star"}},{id:"81",text:"Node-81",data:{myicon:"burger"}},{id:"82",text:"Node-82",data:{myicon:"burger"}},{id:"83",text:"Node-83",data:{myicon:"star"}},{id:"84",text:"Node-84",data:{myicon:"burger"}},{id:"85",text:"Node-85",data:{myicon:"gift"}},{id:"91",text:"Node-91",data:{myicon:"gift"}},{id:"92",text:"Node-82",data:{myicon:"gift"}},{id:"51",text:"Node-51",data:{myicon:"gift"}},{id:"52",text:"Node-52",data:{myicon:"gift"}},{id:"53",text:"Node-53",data:{myicon:"gift"}},{id:"54",text:"Node-54",data:{myicon:"gift"}},{id:"55",text:"Node-55",data:{myicon:"gift"}},{id:"5",text:"Node-5",data:{myicon:"gift"}}],lines:[{from:"7",to:"71",text:"Line text1"},{from:"7",to:"72",text:"Line text2"},{from:"7",to:"73",text:"Line text3"},{from:"8",to:"81",text:"Line text4"},{from:"8",to:"82",text:"Line text5"},{from:"8",to:"83",text:"Line text6"},{from:"8",to:"84",text:"Line text7"},{from:"8",to:"85",text:"Line text8"},{from:"9",to:"91",text:"Line text9"},{from:"9",to:"92",text:"Line text10"},{from:"5",to:"51",text:"Line text11"},{from:"5",to:"52",text:"Line text12"},{from:"5",to:"53",text:"Line text13"},{from:"5",to:"54",text:"Line text14"},{from:"5",to:"55",text:"Line text15"},{from:"1",to:"2",text:"Line Text16"},{from:"3",to:"1",text:"Line Text17"},{from:"4",to:"2",text:"Line Text18"},{from:"6",to:"2",text:"Line Text19"},{from:"7",to:"2",text:"Line Text20"},{from:"8",to:"2",text:"Line Text21"},{from:"9",to:"2",text:"Line Text22"},{from:"1",to:"5",text:"Line Text23"}]},t=(o=s.current)==null?void 0:o.getInstance();await(t==null?void 0:t.setJsonData(e)),await(t==null?void 0:t.moveToCenter()),await(t==null?void 0:t.zoomToFit())},Y=(e,t)=>{console.log("onNodeClick:",e),r()},D=(e,t,o)=>{console.log("onLineClick:",e),r()},r=()=>{k(!1),L(!1),h(!1),N(!1)},H=(e,t,o)=>{console.log("onContextmenu:",t,o),r(),t==="node"&&V(e,o),t==="link"&&G(e,o)},V=(e,t)=>{const o=s.current.getInstance();o.setCheckedNode(t.id);const i=o.options.fullscreen?{x:0,y:0}:o.getBoundingClientRect();console.log("showNodeContextMenu:",t.id,t.text),m(t),L(!0),_({x:e.clientX-i.x+10,y:e.clientY-i.y+10})},G=(e,t)=>{const o=g(e.target);console.log("showLinkContextMenu:",o,t.fromNode.text," > ",t.toNode.text),w(t),T(t.relations[o]);const i=s.current.getInstance();i.setCheckedLinkAndLine(t,a);const p=i.options.fullscreen?{x:0,y:0}:i.getBoundingClientRect();k(!0),R({x:e.clientX-p.x+10,y:e.clientY-p.y+10})},J=e=>{var o;console.log("onCanvasClick:",e),r();const t=(o=s.current)==null?void 0:o.getInstance();t==null||t.clearChecked()},W=e=>{const t=s.current.getInstance(),o=t.isNode(e.target);if(console.log("onMouseMove:",o),o)q(e,o),h(!0);else{h(!1);const i=t.isLink(e.target);i?(K(e,i),N(!0)):N(!1)}},q=(e,t)=>{const o=s.current.getInstance();console.log("showNodeTips:",t);const i=o.options.fullscreen?{x:0,y:0}:o.getBoundingClientRect();m(t),I({x:e.clientX-i.x+10,y:e.clientY-i.y+10})},K=(e,t)=>{const o=s.current.getInstance();console.log("showLineTips:",e.clientX,e.clientY,a);const i=o.options.fullscreen?{x:0,y:0}:o.getBoundingClientRect();B({x:e.clientX-i.x+10,y:e.clientY-i.y+10});const p=g(e.target);w(t),T(t.relations[p])},u=e=>{console.log(`Operation:[${e}] To Node[${c==null?void 0:c.text}]`),r()},f=e=>{console.log(`Operation:[${e}] To Line[${a==null?void 0:a.text}]`),r()},M=()=>{if(document.fullscreenElement){console.log("div\u8FDB\u5165\u5168\u5C4F\u6A21\u5F0F",document.fullscreenElement),console.log("graphRef",s.current);const e=s.current.getInstance();e.$dom===document.fullscreenElement&&(console.log("relation-graph\u88AB\u5168\u5C4F\u4E86!"),setTimeout(async()=>{await(e==null?void 0:e.resetViewSize()),await(e==null?void 0:e.moveToCenter()),await(e==null?void 0:e.zoomToFit()),console.log("relation-graph \u91CD\u7F6E\u5B8C\u6210!")},500))}else console.log("div\u9000\u51FA\u5168\u5C4F\u6A21\u5F0F"),setTimeout(async()=>{var t;const e=(t=s.current)==null?void 0:t.getInstance();await(e==null?void 0:e.resetViewSize()),await(e==null?void 0:e.moveToCenter()),await(e==null?void 0:e.zoomToFit()),console.log("relation-graph \u91CD\u7F6E\u5B8C\u6210!")},500)};l.exports.useEffect(()=>(X(),document.addEventListener("fullscreenchange",M),()=>{document.removeEventListener("fullscreenchange",M)}),[]);const g=(e,t=0)=>t>10||e.tagName==="body"?-1:e.parentElement.classList.contains("rel-link-peel")?Array.from(e.parentElement.children).indexOf(e):g(e.parentElement,t+1);return n("div",{children:n("div",{className:"c-my-graph-theme",style:{height:"100vh"},onMouseMove:W,children:n(Q,{ref:s,options:b,onNodeClick:Y,onLineClick:D,onCanvasClick:J,onContextmenu:H,nodeSlot:Z,graphPlugSlot:d("div",{children:[C||F&&n("div",{className:"c-operation-mask-bg",onClick:r}),C&&d("div",{className:"c-context-menu-panel",style:{left:v.x+"px",top:v.y+"px"},children:[d("div",{style:{lineHeight:"25px",paddingLeft:"10px",color:"#888888",fontSize:"12px"},children:["Node[",c==null?void 0:c.text,"]Actions\uFF1A"]}),n("div",{className:"c-node-menu-item",onClick:()=>u("Node Action 1"),children:"Action 1"}),n("div",{className:"c-node-menu-item",onClick:()=>u("Node Action 2"),children:"Action 2"}),n("div",{className:"c-node-menu-item",onClick:()=>u("Node Action 3"),children:"Action 3"}),n("div",{className:"c-node-menu-item",onClick:()=>u("Node Action 4"),children:"Action 4"})]}),E&&d("div",{className:"c-tips",style:{left:y.x+"px",top:y.y+"px"},children:[d("div",{children:["NodeId: ",c.text]}),d("div",{children:["Icon: ",(P=c.data)==null?void 0:P.myicon]})]}),F&&d("div",{className:"c-context-menu-panel",style:{left:A.x+"px",top:A.y+"px"},children:[d("div",{style:{lineHeight:"25px",paddingLeft:"10px",color:"#888888",fontSize:"12px"},children:["Line[",a==null?void 0:a.text,"]Actions\uFF1A"]}),n("div",{className:"c-node-menu-item",onClick:()=>f("Line Action 1"),children:"Action 1"}),n("div",{className:"c-node-menu-item",onClick:()=>f("Line Action 2"),children:"Action 2"}),n("div",{className:"c-node-menu-item",onClick:()=>f("Line Action 3"),children:"Action 3"}),n("div",{className:"c-node-menu-item",onClick:()=>f("Line Action 4"),children:"Action 4"})]}),z&&d("div",{className:"c-tips",style:{left:S.x+"px",top:S.y+"px"},children:[d("div",{children:["Text: ",a==null?void 0:a.text]}),d("div",{children:["From Node: ",x==null?void 0:x.fromNode.text]}),d("div",{children:["To Node: ",x==null?void 0:x.toNode.text]})]}),n("div",{className:"c-my-panel w-96 rounded-lg absolute left-20 top-20 z-20 p-4 bg-white border-solid border-2 border-black shadow-lg",children:d("div",{className:"c-option-name",style:{lineHeight:"25px"},children:[n("div",{children:"This example mainly demonstrates:"}),n("div",{children:'Hovering over the "node" and "line" will display tooltips'}),n("div",{children:'Right-clicking on the "node" and "line" will display context menus'}),n("div",{children:"These operation-related panels can still be used after full screen"})]})})]})})})})},Z=({node:s})=>{var c,m;return n("div",{children:d("div",{children:[n("div",{className:"c-my-node-icon",children:n(U,{style:{fontSize:"30px"},name:(c=s.data)==null?void 0:c.myicon})}),n("div",{className:"c-my-node-name",children:(m=s.data)==null?void 0:m.myicon})]})})};export{te as default};
