import{r as s,a as i,j as u}from"./index.7473cb17.js";import{u as _}from"./relation-graph.26f01d58.js";import{ElNotification as h}from"./RGComponentsForDemo.afa6e56e.js";import{MyGraphToolbar as A}from"./VipMyGraphToolbar.3181d5ae.js";/* empty css                          */const y={rootId:"2",nodes:[{id:"1",text:"Node-1"},{id:"2",text:"Node-2"},{id:"3",text:"Node-3"},{id:"4",text:"Node-4"},{id:"6",text:"Node-6"},{id:"7",text:"Node-7"},{id:"8",text:"Node-8"},{id:"9",text:"Node-9"},{id:"71",text:"Node-71"},{id:"72",text:"Node-72"},{id:"73",text:"Node-73"},{id:"81",text:"Node-81"},{id:"82",text:"Node-82"},{id:"83",text:"Node-83"},{id:"84",text:"Node-84"},{id:"85",text:"Node-85"},{id:"91",text:"Node-91"},{id:"92",text:"Node-82"},{id:"5",text:"Node-5"}],lines:[{from:"7",to:"71",text:"Investment"},{from:"7",to:"72",text:"Investment"},{from:"7",to:"73",text:"Investment"},{from:"8",to:"81",text:"Investment"},{from:"8",to:"82",text:"Investment"},{from:"8",to:"83",text:"Investment"},{from:"8",to:"84",text:"Investment"},{from:"8",to:"85",text:"Investment"},{from:"9",to:"91",text:"Investment"},{from:"9",to:"92",text:"Investment"},{from:"1",to:"2",text:"Investment"},{from:"3",to:"1",text:"Executive"},{from:"4",to:"2",text:"Executive"},{from:"6",to:"2",text:"Executive"},{from:"7",to:"2",text:"Executive"},{from:"8",to:"2",text:"Executive"},{from:"9",to:"2",text:"Executive"},{from:"1",to:"5",text:"Investment"}]},q={disableDragLine:!1,allowSwitchLineShape:!0,allowSwitchJunctionPoint:!0,allowShowDownloadButton:!0,defaultJunctionPoint:"border",layout:{layoutName:"center"}},W={debug:!1,disableDragLine:!1,allowSwitchLineShape:!0,allowSwitchJunctionPoint:!0,allowShowDownloadButton:!0,defaultJunctionPoint:"border",defaultExpandHolderPosition:"right",layout:{layoutName:"fixed"}},V=()=>{var w,I;const r=s.exports.useRef(null),[C,x]=s.exports.useState(!1),[p,D]=s.exports.useState({x:0,y:0}),[d,L]=s.exports.useState(),[c,b]=s.exports.useState(),S=s.exports.useRef(1),k=s.exports.useRef(1),[g,P]=s.exports.useState(!0);s.exports.useState(!1);const[z,J]=s.exports.useState(""),f=s.exports.useRef(),[l,E]=s.exports.useState();l!=null&&l.account;const T=async()=>{if(await h({title:"Tip:",message:"This is an example that allows you to modify and save the graph, and restore the saved state when opened again.",type:"success",duration:2e4}),console.log("userInfo:",l),!l)await h({title:"This example requires you to log in",message:"This example requires you to log in to demonstrate saving and restore the state when opened again.",type:"success",duration:2e4}),await m(y);else{const t=l.userId+"-my-demo";J(t),j(t)}},j=async t=>{const e=await O(t);e?(await h({title:"Display the saved graph state",message:"You have saved this graph before, and now restore the data state you saved before.",type:"success",duration:2e4}),await r.current.getInstance().setOptions(W),await m(e)):(await h({title:"You are opening the graph for the first time",message:"You have not saved this graph before, so the default data is displayed and the data will be assigned positions by the layouter.",type:"success",duration:2e4}),await m(y))},O=async t=>{const e=await U("/my-graph/get-graph",{docId:t,ignoreErrors:!0});if(e.data&&e.data.data){const o=e.data.data,{docContent:a}=o;console.log("graphInfo:",o);const n=JSON.parse(a);return console.log("graphJsonData.jsonData:",n.jsonData),console.log("graphJsonData.options:",n.options),n.jsonData}else return null},m=async t=>{const e=r.current.getInstance();await e.setJsonData(t),await e.moveToCenter(),await e.zoomToFit()},B=(t,e,o)=>{console.log("onContextmenu:",e,o);const a=r.current.getInstance();L(e),b(o);const n=a.getBoundingClientRect();console.log("showNodeMenus:",t,n),x(!0),D({x:t.clientX-n.x+10,y:t.clientY-n.y+10});const N=()=>{x(!1),document.body.removeEventListener("click",N)};document.body.addEventListener("click",N)},G=t=>{const e=r.current.getInstance(),o=e.getBoundingClientRect(),a=e.getCanvasCoordinateByClientCoordinate({x:p.x-10+o.x,y:p.y-10+o.y}),n=S.current++;e.addNodes([{id:"addFromCanvas-"+n,text:"New-"+n,color:"#5da0f8",x:a.x,y:a.y}])},R=t=>{r.current.getInstance().removeNodeById(c.id)},M=t=>{r.current.getInstance().removeLinkById(c.seeks_id)},F=t=>{const e=r.current.getInstance();e.startCreatingLinePlot(t,{template:{lineWidth:3,color:"#e85f84",text:"New Link"},fromNode:c,onCreateLine:(o,a)=>{if(console.log("New Link:",o,a),a.id){const n=k.current++;e.addLines([{from:o.id,to:a.id,lineWidth:3,color:"#e85f84",text:"New Link"+n}])}}})},U=async(t,e)=>new Promise((o,a)=>{window.top.postMessage({action:"postJson",url:t,data:e},v),f.current=n=>{o(n)}}),Y=async t=>{console.log("React:receive.data:",t.origin,t.data);const{action:e,data:o}=t.data;e==="setUserInfo"?(E(o),P(!1)):e==="returnPostJson"&&f.current(o)};s.exports.useEffect(()=>{window.addEventListener("message",Y),setTimeout(()=>{window.top.postMessage({action:"getUserInfo"},v)},1e3)},[]),s.exports.useEffect(()=>{!g&&T()},[g]);const v=window.origin;return i("div",{children:i("div",{style:{height:"calc(100vh)"},children:i(_,{ref:r,options:q,onContextmenu:B,toolBarSlot:A,graphPlugSlot:i("div",{children:C&&u("div",{style:{left:p.x+"px",top:p.y+"px"},className:"c-right-menu-panel",children:[u("div",{className:"c-object-info",children:[i("div",{children:"Current right-click event information:"}),u("div",{children:["Type: ",d]}),d==="link"&&u("div",{children:[(w=c.fromNode)==null?void 0:w.text," -> ",(I=c.toNode)==null?void 0:I.text]}),d==="node"&&u("div",{children:["ID: ",c.id]}),d==="node"&&u("div",{children:["Text: ",c.text]}),i("div",{children:"You can perform the following operations on this object:"})]}),d==="canvas"&&i("div",{className:"c-node-menu-item",onClick:G,children:"Add Node"}),d==="node"&&i("div",{className:"c-node-menu-item",onClick:R,children:"Delete Node"}),d==="node"&&i("div",{className:"c-node-menu-item",onClick:F,children:"Add Link"}),d==="link"&&i("div",{className:"c-node-menu-item",onClick:M,children:"Delete Link"})]})})})})})};export{V as default};
