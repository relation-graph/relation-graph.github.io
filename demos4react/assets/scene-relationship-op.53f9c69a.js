import{r as i,a as o,j as f}from"./index.7473cb17.js";import{u as E}from"./relation-graph.26f01d58.js";import{I as g}from"./index.e712a3dd.js";import{d as W}from"./Demo4AdvDataFilterData.8ea19753.js";const P=()=>{const s=i.exports.useRef(null),[c,d]=i.exports.useState(!1),[r,a]=i.exports.useState({x:0,y:0,width:120,height:120}),[h,x]=i.exports.useState(""),[n,m]=i.exports.useState(),u=i.exports.useRef(),[v,y]=i.exports.useState(!1);i.exports.useEffect(()=>{w()},[]),i.exports.useEffect(()=>{c&&n&&p()},[c,n]);const C={debug:!1,defaultLineShape:1,placeSingleNode:!1,moveToCenterWhenRefresh:!0,zoomToFitWhenRefresh:!0,layout:{layoutName:"force",maxLayoutTimes:50},defaultNodeBorderWidth:0,defaultNodeColor:"#e85f84"},w=async()=>{var l;const e=W,t=(l=s.current)==null?void 0:l.getInstance();t&&await t.setJsonData(e)},p=()=>{if(console.log("updateNodeMenuPosition:",u.current),!u.current)return;const e=s.current.getInstance();if(e){const t=e.getNodeById(u.current.id);console.log("updateNodeMenuPosition:",t.x,t.y);const l=e.getClientCoordinateByCanvasCoordinate({x:t.x+t.el.offsetWidth/2,y:t.y+t.el.offsetHeight/2});a({x:l.x-e.options.canvasOffset.x-r.width/2,y:l.y-e.options.canvasOffset.y-r.height/2,width:r.width,height:r.height})}},I=(e,t)=>{u.current=e,m(e),d(!0)},b=()=>{var t;const e=(t=s.current)==null?void 0:t.getInstance();e&&e.clearChecked(),d(!1),y(!1)},L=(e,t)=>{d(!1),console.log("Node:",n.text,"Menu Event:",e),e==="1"?y(!v):e==="2"?k():e==="3"?z(t):e==="4"&&M()},S=e=>{n&&(n.text=e,s.current.getInstance().dataUpdated(),x(e))},k=()=>{const e=s.current.getInstance();if(e&&n){const l={id:e.generateNewNodeId(),color:n.color,text:n.text,borderColor:n.borderColor,data:{...n.data},force_weight:20,x:n.x+60,y:n.y+60};e.addNodes([l]),e.layouter.allLinks=e.getLinks(),e.layouter.allNodes=e.getNodes(),e.layouter.autoLayout()}},M=()=>{const e=s.current.getInstance(),t=e.generateNewNodeId();e.addNodes([{id:t,text:"New Node",x:n.x+60,y:n.y+60}]),e.addLines([{from:n.id,to:t}]),e.layouter.allLinks=e.getLinks(),e.layouter.allNodes=e.getNodes(),e.layouter.autoLayout()},R=(e,t)=>{if(n){const l=s.current.getInstance();e==="text"&&(n.text=t),e==="color"&&(n.color=t),e==="borderColor"&&(n.borderColor=t),e==="icon"&&(n.data.icon=t),m(n),l.dataUpdated(),x(t)}},z=e=>{const t=s.current.getInstance();t.startCreatingLinePlot(e,{template:{lineWidth:2,color:"#8080ff",text:"New Line"},fromNode:n,onCreateLine:(l,N)=>{console.log("New Line\uFF1A",l,N),N.id&&t.addLines([{from:l.id,to:N.id,lineWidth:3,color:"#8080ff",text:"New Line"}])}})};return o("div",{children:o("div",{style:{height:"100vh"},children:o(E,{ref:s,options:C,onNodeClick:I,onCanvasClick:b,onZoomEnd:p,onNodeDragEnd:p,onCanvasDragEnd:p,nodeSlot:({node:e})=>{var t;return f("div",{className:"h-full",children:[o("div",{className:"my-node-style",style:{backgroundImage:`url(${(t=e.data)==null?void 0:t.icon})`}}),o("div",{className:"c-node-name",style:{color:e.color},children:e.text})]})},graphPlugSlot:f("div",{children:[c&&o(B,{nodeMenuPanel:r,currentNodeText:n.text,onUpdateCurrentNodeText:S,onClickNodeMenu:L}),v&&n&&o($,{currentNode:u.current,text:n.text,color:n.color,borderColor:n.borderColor,icon:n.data.icon,updateNodeProperty:R})]})})})})},B=({nodeMenuPanel:s,currentNodeText:c,onUpdateCurrentNodeText:d,onClickNodeMenu:r})=>f("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",placeItems:"center",width:`${s.width}px`,height:`${s.height}px`,left:`${s.x}px`,top:`${s.y}px`},className:"c-surround-menu-panel",children:[o("svg",{width:"100%",height:"100%",viewBox:"0 0 400 400",children:o("g",{children:f("g",{fill:"#000000",children:[o("path",{className:"c-svg-button",d:"m9.99469,187.08997c0,-40.82082 27.52652,-97.86001 62.20722,-128.85359c32.50037,-29.06937 66.90853,-43.9133 114.603,-49.41106l7.15417,-0.82466l0,61.84972l0,61.91844l-4.49691,0c-23.5747,0 -58.05098,34.01735 -58.18725,57.3828l0,4.46692l-60.64011,0l-60.64011,0l0,-6.52858",onClick:a=>r("1",a)}),o("path",{className:"c-svg-button",d:"m269.58887,188.4644c-4.36064,-26.73282 -34.27188,-56.69558 -56.68828,-56.69558l-3.95183,0l0,-61.781l0,-61.71228l7.83552,0.68722c91.98219,8.52152 166.11303,82.60374 174.22109,174.00389l0.95389,10.6519l-60.77638,0l-60.77638,0l-0.81762,-5.15414",onClick:a=>r("2",a)}),o("path",{className:"c-svg-button",d:"m176.92533,393.32443c-89.32493,-11.68273 -166.93065,-94.35519 -166.93065,-177.92103l0,-6.66603l60.43571,0l60.50384,0l0.68135,5.97881c2.52099,23.09056 29.02549,50.99166 52.12324,55.04625c11.3104,1.99294 10.22024,-4.87926 10.22024,63.43033l0,61.09378l-6.47282,-0.20617c-3.54302,-0.13744 -8.31246,-0.41233 -10.56092,-0.75594",onClick:a=>r("3",a)}),o("path",{className:"c-svg-button",d:"m209.28944,332.98659l0.34067,-61.57483l7.49485,-1.64933c7.08604,-1.51188 11.51481,-3.22993 21.12184,-8.4528c6.06401,-3.22993 20.03168,-18.28003 23.43843,-25.22094c4.97385,-10.17084 7.22231,-15.94348 7.22231,-18.62364c0,-1.37444 0.40881,-3.91715 0.88575,-5.6352l0.81762,-3.09249l60.43571,0l60.50384,0l0,5.15414c-0.06813,86.31472 -81.62568,171.87351 -171.35942,179.77653l-11.24227,0.96211l0.34067,-61.64356",onClick:a=>r("4",a)})]})})}),f("div",{style:{height:"100%",width:"100%",position:"absolute",left:0,top:0,userSelect:"none",pointerEvents:"none",color:"#ffffff",fontSize:"22px"},children:[o("div",{style:{position:"absolute",left:20,top:20},children:o(g,{color:"#ffffff",size:"20px",name:"circle_info"})}),o("div",{style:{position:"absolute",right:20,top:20},children:o(g,{color:"#ffffff",size:"20px",name:"link"})}),o("div",{style:{position:"absolute",left:20,top:75,transform:"rotate(180deg)"},children:o(g,{color:"#ffffff",size:"20px",name:"maximize_1"})}),o("div",{style:{position:"absolute",right:20,top:75},children:o(g,{color:"#ffffff",size:"20px",name:"circle_plus"})})]}),o("div",{className:"c-current-node-text",children:o("input",{value:c,onChange:a=>d(a.target.value)})})]}),$=({color:s,text:c,icon:d,borderColor:r,updateNodeProperty:a})=>o("div",{className:"c-operate-panels",children:f("div",{className:"c-node-info-card",style:{backgroundColor:s},children:[f("div",{style:{borderBottom:"#ffffff solid 1px"},children:["Name: ",c]}),o("div",{style:{borderBottom:"#ffffff solid 1px"},children:"Position: What you want to show"}),"Avatar:",o("img",{className:"c-person-pic",src:d}),f("div",{className:"c-node-options-panel",children:[o("div",{children:"Name:"}),o("input",{value:c,onChange:h=>{a("text",h.target.value)},style:{width:"100%"}}),o("div",{children:"Color:"}),o("input",{value:r,onChange:h=>{a("borderColor",h.target.value)},style:{width:"100%"}}),o("div",{children:"Avatar:"}),o("input",{value:d,onChange:h=>{a("icon",h.target.value)},style:{width:"100%"}})]})]})});export{P as default};
